# config/services.yaml
#
# This file is the entry point to configure your own services.
# Files in the packages/ subdirectory configure your dependencies.
#
# Put parameters here that don't need to change on production right away.
# https://symfony.com/doc/current/best_practices.html#use-parameters-for-application-configuration

parameters:
    # Répertoire de stockage des fichiers uploadés (documents admin + utilisateurs)
    documents_directory: '%kernel.project_dir%/var/documents'

    # Répertoire de stockage des images de projets
    # Hors public/ — accès via contrôleur uniquement (BinaryFileResponse)
    # Route admin   : /admin/gestion-projets/image/{id}  (ROLE_ADMIN)
    # Route publique: /projets/image/{id}                (publique, images vitrine)
    projets_images_directory: '%kernel.project_dir%/var/projets'

services:
    # default configuration for services in *this* file
    _defaults:
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, etc.

    # makes classes in src/ available to be used as services
    # this creates a service per class whose id is the fully-qualified class name
    App\:
        resource: '../src/'
        exclude:
            - '../src/DependencyInjection/'
            - '../src/Entity/'
            - '../src/Kernel.php'

    # ── Bindings des Rate Limiters ──────────────────────────────────────────
    # Injecte automatiquement les factories de rate limiter dans les contrôleurs
    # via l'argument typé RateLimiterFactory + le nom de l'argument.
    #
    # Naming convention : $nomLimiter → limiter nommé 'nom' dans rate_limiter.yaml
    # Exemple : $inscriptionLimiter → limiter 'inscription'
    #           $passwordResetLimiter → limiter 'password_reset'
    #
    # Voir : https://symfony.com/doc/current/rate_limiter.html

    App\Controller\auth\InscriptionController:
        arguments:
            $inscriptionLimiter: '@limiter.inscription'

    App\Controller\utilisateur\CompteController:
        arguments:
            $passwordResetLimiter: '@limiter.password_reset'

    # ── Security Headers Subscriber ─────────────────────────────────────────
    # Enregistré automatiquement via autoconfigure (tag kernel.event_subscriber)
    App\EventSubscriber\SecurityHeadersSubscriber: ~