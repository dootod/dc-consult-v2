{% extends 'admin/admin_base.html.twig' %}

{% block title %}Modifier {{ utilisateur.prenom }} {{ utilisateur.nom }}{% endblock %}

{% block body %}

{% for label, messages in app.flashes %}
    {% for message in messages %}
        {% set alertClass =
            label == 'success' ? 'dc-alert--success' :
            (label == 'danger'  ? 'dc-alert--danger'  :
            (label == 'warning' ? 'dc-alert--warning'  : 'dc-alert--info'))
        %}
        {% set iconClass =
            label == 'success' ? 'fa-circle-check' :
            (label == 'danger'  ? 'fa-triangle-exclamation' :
            (label == 'warning' ? 'fa-triangle-exclamation'  : 'fa-circle-info'))
        %}
        <div class="dc-alert {{ alertClass }}">
            <i class="fa-solid {{ iconClass }}"></i>
            <span>{{ message }}</span>
        </div>
    {% endfor %}
{% endfor %}

{# ── En-tête ── #}
<div class="mb-4">
    <h1 class="admin-page-header__title">
        Modifier {{ utilisateur.prenom }} {{ utilisateur.nom }}
    </h1>
    <p class="admin-page-header__sub">Mettez à jour les informations de l'utilisateur.</p>
</div>

{# ── Layout centré ── #}
<div class="row justify-content-center">
    <div class="col-12 col-lg-6">
        <div class="dc-card">
            <div class="dc-card__head">
                <span class="dc-card__title">
                    <i class="fa-solid fa-pen"></i>
                    Modification de l'utilisateur
                </span>
            </div>
            <div class="dc-card__body">

                {{ form_start(form, {attr: {novalidate: 'novalidate'}}) }}

                    <div class="mb-3">
                        <label class="dc-form-label" for="{{ form.nom.vars.id }}">Nom <span class="text-danger">*</span></label>
                        {{ form_widget(form.nom, {attr: {class: 'dc-form-control'}}) }}
                        {{ form_errors(form.nom) }}
                    </div>

                    <div class="mb-3">
                        <label class="dc-form-label" for="{{ form.prenom.vars.id }}">Prénom <span class="text-danger">*</span></label>
                        {{ form_widget(form.prenom, {attr: {class: 'dc-form-control'}}) }}
                        {{ form_errors(form.prenom) }}
                    </div>

                    <div class="mb-3">
                        <label class="dc-form-label" for="{{ form.email.vars.id }}">Email <span class="text-danger">*</span></label>
                        {{ form_widget(form.email, {attr: {class: 'dc-form-control'}}) }}
                        {{ form_errors(form.email) }}
                    </div>

                    <div class="mb-3">
                        <label class="dc-form-label" for="{{ form.password.vars.id }}">Nouveau mot de passe</label>
                        <small class="text-muted d-block mb-2">Laissez vide pour conserver le mot de passe actuel</small>
                        {{ form_widget(form.password, {attr: {class: 'dc-form-control'}}) }}
                        {{ form_errors(form.password) }}
                    </div>

                    <div class="mb-4">
                        <label class="dc-form-label" for="{{ form.role_choice.vars.id }}">Rôle <span class="text-danger">*</span></label>
                        {{ form_widget(form.role_choice, {attr: {class: 'dc-form-control'}}) }}
                        {{ form_errors(form.role_choice) }}
                    </div>

                    <div class="d-flex justify-content-between gap-2">
                        <a href="{{ path('app_show_gestion_utilisateurs', {id: utilisateur.id}) }}" class="dc-btn dc-btn--outline">
                            <i class="fa-solid fa-arrow-left"></i>
                            Retour
                        </a>
                        <button type="submit" class="dc-btn dc-btn--primary">
                            <i class="fa-solid fa-floppy-disk"></i>
                            Enregistrer les modifications
                        </button>
                    </div>

                {{ form_end(form) }}

            </div>
        </div>
    </div>
</div>

{% endblock %}
