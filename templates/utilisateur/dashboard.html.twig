{% extends 'espace.html.twig' %}

{% block title %}Mon tableau de bord{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('styles/dashboard.css') }}">
{% endblock %}

{% block body %}

{# â”€â”€ En-tÃªte â”€â”€ #}
<div class="dash-header mb-4">
    <div class="dash-header__left">
        <div class="dash-header__avatar">
            {{ utilisateur.prenom|first|upper }}{{ utilisateur.nom|first|upper }}
        </div>
        <div>
            <h1 class="dash-header__title">
                Bonjour, <span class="text-primary">{{ utilisateur.prenom }}</span> ðŸ‘‹
            </h1>
            <p class="dash-header__sub">Bienvenue dans votre espace personnel DC Consult.</p>
        </div>
    </div>
    <div class="dash-header__date">
        <i class="fa-regular fa-calendar"></i>
        {{ dateAujourdhui }}
    </div>
</div>

{# â”€â”€ Statistiques â”€â”€ #}
<div class="row g-3 mb-4">
    <div class="col-6 col-lg-4">
        <div class="stat-card">
            <div class="stat-card__icon stat-card__icon--blue">
                <i class="fa-solid fa-file-lines"></i>
            </div>
            <div>
                <div class="stat-card__value">{{ stats.documents_recus }}</div>
                <div class="stat-card__label">Documents reÃ§us</div>
            </div>
        </div>
    </div>
    <div class="col-6 col-lg-4">
        <div class="stat-card">
            <div class="stat-card__icon stat-card__icon--green">
                <i class="fa-solid fa-cloud-arrow-up"></i>
            </div>
            <div>
                <div class="stat-card__value">{{ stats.documents_perso }}</div>
                <div class="stat-card__label">Mes dÃ©pÃ´ts</div>
            </div>
        </div>
    </div>
    <div class="col-12 col-lg-4">
        <div class="stat-card">
            <div class="stat-card__icon stat-card__icon--orange">
                <i class="fa-solid fa-folder-open"></i>
            </div>
            <div>
                <div class="stat-card__value">{{ stats.total_documents }}</div>
                <div class="stat-card__label">Total documents</div>
            </div>
        </div>
    </div>
</div>

{# â”€â”€ Blocs principaux â”€â”€ #}
<div class="row g-3 mb-3">

    {# Derniers documents reÃ§us #}
    <div class="col-12 col-lg-7">
        <div class="dc-card h-100">
            <div class="dc-card__head">
                <span class="dc-card__title">
                    <i class="fa-solid fa-inbox"></i>
                    Documents reÃ§us rÃ©cemment
                </span>
                <a href="{{ path('app_mes_documents') }}" class="dc-badge dc-badge--blue">
                    Voir tout
                </a>
            </div>
            <div class="dc-card__body">
                {% if recentDocumentsAdmin is not empty %}
                    {% for doc in recentDocumentsAdmin %}
                        <div class="activity-item">
                            <div class="activity-dot activity-dot--blue"></div>
                            <div class="flex-grow-1">
                                <div class="activity-item__text">
                                    <i class="fa-regular fa-file-pdf me-1" style="color:var(--color-primary); font-size:0.8rem;"></i>
                                    {{ doc.nom }}
                                </div>
                                <div class="activity-item__time">
                                    {% if doc.deposeLe %}
                                        ReÃ§u le {{ doc.deposeLe|date('d/m/Y Ã  H:i') }}
                                    {% endif %}
                                </div>
                            </div>
                            <a href="{{ path('app_mes_documents') }}" class="dash-doc-link" title="Voir">
                                <i class="fa-solid fa-arrow-right"></i>
                            </a>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="dc-empty-state dc-empty-state--sm">
                        <i class="fa-regular fa-folder-open"></i>
                        <p>Aucun document reÃ§u pour l'instant.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    {# AccÃ¨s rapides #}
    <div class="col-12 col-lg-5">
        <div class="dc-card h-100">
            <div class="dc-card__head">
                <span class="dc-card__title">
                    <i class="fa-solid fa-bolt"></i>
                    AccÃ¨s rapides
                </span>
            </div>
            <div class="dc-card__body">
                <div class="row g-2">
                    <div class="col-6">
                        <a href="{{ path('app_mes_documents') }}" class="quick-link">
                            <i class="fa-solid fa-file-lines"></i>
                            Mes documents
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ path('app_new_mes_documents') }}" class="quick-link">
                            <i class="fa-solid fa-cloud-arrow-up"></i>
                            DÃ©poser un fichier
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ path('app_compte') }}" class="quick-link">
                            <i class="fa-solid fa-circle-user"></i>
                            Mon profil
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ path('app_contact') }}" class="quick-link">
                            <i class="fa-solid fa-envelope"></i>
                            Nous contacter
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

{# â”€â”€ Ligne infÃ©rieure : Profil + Informations â”€â”€ #}
<div class="row g-3">

    {# Infos du compte #}
    <div class="col-12 col-lg-5">
        <div class="dc-card h-100">
            <div class="dc-card__head">
                <span class="dc-card__title">
                    <i class="fa-solid fa-circle-user"></i>
                    Mon profil
                </span>
                <a href="{{ path('app_compte') }}" class="dc-badge dc-badge--blue">Modifier</a>
            </div>
            <div class="dc-card__body">
                <div class="dash-profile">
                    <div class="dash-profile__avatar">
                        {{ utilisateur.prenom|first|upper }}{{ utilisateur.nom|first|upper }}
                    </div>
                    <div class="dash-profile__info">
                        <div class="dash-profile__name">{{ utilisateur.prenom }} {{ utilisateur.nom }}</div>
                        <div class="dash-profile__email">{{ utilisateur.email }}</div>
                        <span class="dash-profile__role">
                            {% if is_granted('ROLE_ADMIN') %}
                                <i class="fa-solid fa-shield-halved"></i> Administrateur
                            {% else %}
                                <i class="fa-solid fa-user"></i> Utilisateur
                            {% endif %}
                        </span>
                    </div>
                </div>

                <div class="dash-profile__fields mt-3">
                    <div class="dash-profile__field">
                        <span class="dash-profile__field-label">Nom</span>
                        <span class="dash-profile__field-value">{{ utilisateur.nom }}</span>
                    </div>
                    <div class="dash-profile__field">
                        <span class="dash-profile__field-label">PrÃ©nom</span>
                        <span class="dash-profile__field-value">{{ utilisateur.prenom }}</span>
                    </div>
                    <div class="dash-profile__field">
                        <span class="dash-profile__field-label">Email</span>
                        <span class="dash-profile__field-value">{{ utilisateur.email }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {# Ã€ propos & aide #}
    <div class="col-12 col-lg-7">
        <div class="dc-card h-100">
            <div class="dc-card__head">
                <span class="dc-card__title">
                    <i class="fa-solid fa-circle-info"></i>
                    Votre espace DC Consult
                </span>
            </div>
            <div class="dc-card__body">
                <div class="dash-info-grid">
                    <div class="dash-info-item">
                        <div class="dash-info-item__icon dash-info-item__icon--blue">
                            <i class="fa-solid fa-file-arrow-down"></i>
                        </div>
                        <div>
                            <div class="dash-info-item__title">Recevoir des documents</div>
                            <div class="dash-info-item__desc">Votre conseiller peut vous transmettre des documents directement via cette plateforme sÃ©curisÃ©e.</div>
                        </div>
                    </div>
                    <div class="dash-info-item">
                        <div class="dash-info-item__icon dash-info-item__icon--green">
                            <i class="fa-solid fa-cloud-arrow-up"></i>
                        </div>
                        <div>
                            <div class="dash-info-item__title">DÃ©poser vos fichiers</div>
                            <div class="dash-info-item__desc">Partagez vos documents avec votre conseiller en toute simplicitÃ© depuis la rubrique Mes documents.</div>
                        </div>
                    </div>
                    <div class="dash-info-item">
                        <div class="dash-info-item__icon dash-info-item__icon--orange">
                            <i class="fa-solid fa-shield-halved"></i>
                        </div>
                        <div>
                            <div class="dash-info-item__title">Espace sÃ©curisÃ©</div>
                            <div class="dash-info-item__desc">Vos donnÃ©es et vos documents sont protÃ©gÃ©s et accessibles uniquement par vous et votre conseiller.</div>
                        </div>
                    </div>
                    <div class="dash-info-item">
                        <div class="dash-info-item__icon dash-info-item__icon--purple">
                            <i class="fa-solid fa-headset"></i>
                        </div>
                        <div>
                            <div class="dash-info-item__title">Besoin d'aide ?</div>
                            <div class="dash-info-item__desc">
                                <a href="{{ path('app_contact') }}" style="color:var(--color-primary); font-weight:600;">Contactez-nous</a>
                                â€” notre Ã©quipe est disponible pour rÃ©pondre Ã  vos questions.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

{% endblock %}
